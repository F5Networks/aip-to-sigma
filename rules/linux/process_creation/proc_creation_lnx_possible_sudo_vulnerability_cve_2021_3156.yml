title: Possible Sudo Vulnerability CVE-2021-3156
id: 94a4ea06-26b3-11ec-9e1c-93ae015503f4
status: stable
description: Detects potential exploitation of CVE-2021-3156. Licensed under DRL v1.1, original rule copyright F5, Inc.
references:
author: Ethan Hansen - Security Engineer, F5 Inc
date: 2023/06/14
logsource:
    product: linux
    category: process_creation
detection:
    selection_sudoedit:
        CommandLine|contains: 'sudoedit -s'
    selection_user:
        User: root
    selection_slash:
        CommandLine|contains:
            - '/'
            - '\\\\' # this should represent the string "\\" per the Sigma spec but using the Sigma converter has given inconsistent results
    condition: (selection_sudoedit and not selection_user) and selection_slash
fields:
    - User
    - Image
    - CommandLine
falsepositives:
    - Authorized users testing the vulnerability
level: high